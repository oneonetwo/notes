<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shadow DOM è¿›é˜¶ç¤ºä¾‹ - è‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        
        h1, h2 {
            color: #2c3e50;
        }
        
        .container {
            margin: 40px 0;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #3498db;
            text-decoration: none;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .note {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 10px 15px;
            margin: 20px 0;
        }
        
        code {
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">â† è¿”å›ä¸»æ¼”ç¤ºé¡µé¢</a>
    
    <h1>Shadow DOM è¿›é˜¶ç¤ºä¾‹ - è‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨</h1>
    
    <div class="note">
        <p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Shadow DOMåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨ç»„ä»¶ï¼ŒåŒ…å«è‡ªå®šä¹‰æ§åˆ¶ç•Œé¢ã€‚</p>
        <p>Shadow DOMåœ¨è¿™ç§åœºæ™¯ä¸­çš„ä¼˜åŠ¿ï¼š</p>
        <ul>
            <li>æ ·å¼å®Œå…¨å°è£…ï¼Œä¸ä¼šè¢«é¡µé¢ä¸Šçš„å…¶ä»–CSSå½±å“</li>
            <li>DOMç»“æ„éš”ç¦»ï¼Œæé«˜å®‰å…¨æ€§å’Œå¯é æ€§</li>
            <li>ç»„ä»¶å¯ä»¥è½»æ¾åœ°åœ¨ä¸åŒé¡¹ç›®ä¹‹é—´é‡ç”¨</li>
        </ul>
    </div>
    
    <div class="container">
        <h2>è‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨</h2>
        
        <!-- ä½¿ç”¨è‡ªå®šä¹‰å…ƒç´  -->
        <custom-video-player>
            <!-- å°†è§†é¢‘æºä½œä¸ºæ’æ§½å†…å®¹ä¼ å…¥ -->
            <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm" type="video/webm">
            <p>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚</p>
        </custom-video-player>
    </div>
    
    <div class="container">
        <h2>å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç»„ä»¶ï¼Ÿ</h2>
        <p>åœ¨HTMLä¸­å¼•å…¥è‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨éå¸¸ç®€å•ï¼š</p>
        <pre><code>&lt;custom-video-player&gt;
    &lt;source src="your-video.mp4" type="video/mp4"&gt;
    &lt;p&gt;æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚&lt;/p&gt;
&lt;/custom-video-player&gt;</code></pre>
    </div>
    
    <script>
        // å®šä¹‰è‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨ç»„ä»¶
        class CustomVideoPlayer extends HTMLElement {
            constructor() {
                super();
                
                // åˆ›å»ºShadow DOM
                this.attachShadow({ mode: 'open' });
                
                // è®¾ç½®åˆå§‹HTMLå†…å®¹
                this.shadowRoot.innerHTML = `
                    <style>
                        :host {
                            display: block;
                            width: 100%;
                            max-width: 640px;
                            margin: 0 auto;
                            border-radius: 8px;
                            overflow: hidden;
                            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
                        }
                        
                        .video-container {
                            position: relative;
                            width: 100%;
                            background-color: #000;
                        }
                        
                        video {
                            width: 100%;
                            display: block;
                        }
                        
                        .controls {
                            position: absolute;
                            bottom: 0;
                            left: 0;
                            right: 0;
                            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
                            padding: 10px;
                            display: flex;
                            align-items: center;
                            transition: opacity 0.3s;
                            opacity: 0;
                        }
                        
                        .video-container:hover .controls {
                            opacity: 1;
                        }
                        
                        .play-pause {
                            background: transparent;
                            border: none;
                            color: white;
                            width: 30px;
                            height: 30px;
                            font-size: 16px;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                        }
                        
                        .timeline {
                            flex-grow: 1;
                            margin: 0 10px;
                            position: relative;
                            height: 5px;
                            background-color: rgba(255,255,255,0.3);
                            border-radius: 5px;
                            overflow: hidden;
                            cursor: pointer;
                        }
                        
                        .progress {
                            height: 100%;
                            background-color: #3498db;
                            width: 0;
                            transition: width 0.1s;
                        }
                        
                        .volume-control {
                            display: flex;
                            align-items: center;
                            color: white;
                        }
                        
                        .volume-icon {
                            margin-right: 5px;
                            font-size: 16px;
                        }
                        
                        .volume-slider {
                            width: 60px;
                            cursor: pointer;
                        }
                        
                        .time-display {
                            color: white;
                            font-size: 12px;
                            margin-left: 10px;
                            min-width: 80px;
                            text-align: center;
                        }
                    </style>
                    
                    <div class="video-container">
                        <video>
                            <slot></slot>
                        </video>
                        
                        <div class="controls">
                            <button class="play-pause">â–¶</button>
                            
                            <div class="timeline">
                                <div class="progress"></div>
                            </div>
                            
                            <div class="volume-control">
                                <span class="volume-icon">ğŸ”Š</span>
                                <input type="range" class="volume-slider" min="0" max="1" step="0.1" value="0.7">
                            </div>
                            
                            <div class="time-display">0:00 / 0:00</div>
                        </div>
                    </div>
                `;
                
                // è·å–å…ƒç´ 
                this.video = this.shadowRoot.querySelector('video');
                this.playPauseBtn = this.shadowRoot.querySelector('.play-pause');
                this.timeline = this.shadowRoot.querySelector('.timeline');
                this.progress = this.shadowRoot.querySelector('.progress');
                this.volumeSlider = this.shadowRoot.querySelector('.volume-slider');
                this.timeDisplay = this.shadowRoot.querySelector('.time-display');
                
                // ç»‘å®šäº‹ä»¶å¤„ç†æ–¹æ³•
                this.playPauseBtn.addEventListener('click', () => this.togglePlay());
                this.video.addEventListener('timeupdate', () => this.updateProgress());
                this.video.addEventListener('loadedmetadata', () => this.updateTimeDisplay());
                this.timeline.addEventListener('click', (e) => this.seek(e));
                this.volumeSlider.addEventListener('input', () => this.adjustVolume());
                
                // è®¾ç½®åˆå§‹éŸ³é‡
                this.video.volume = this.volumeSlider.value;
            }
            
            // åˆ‡æ¢æ’­æ”¾/æš‚åœ
            togglePlay() {
                if (this.video.paused || this.video.ended) {
                    this.video.play();
                    this.playPauseBtn.textContent = 'âšâš';
                } else {
                    this.video.pause();
                    this.playPauseBtn.textContent = 'â–¶';
                }
            }
            
            // æ›´æ–°è¿›åº¦æ¡
            updateProgress() {
                const percent = (this.video.currentTime / this.video.duration) * 100;
                this.progress.style.width = `${percent}%`;
                this.updateTimeDisplay();
            }
            
            // æ‹–åŠ¨è¿›åº¦æ¡
            seek(e) {
                const rect = this.timeline.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                this.video.currentTime = percent * this.video.duration;
            }
            
            // è°ƒæ•´éŸ³é‡
            adjustVolume() {
                this.video.volume = this.volumeSlider.value;
                if (this.video.volume === 0) {
                    this.shadowRoot.querySelector('.volume-icon').textContent = 'ğŸ”‡';
                } else {
                    this.shadowRoot.querySelector('.volume-icon').textContent = 'ğŸ”Š';
                }
            }
            
            // æ ¼å¼åŒ–æ—¶é—´
            formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                seconds = Math.floor(seconds % 60);
                return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }
            
            // æ›´æ–°æ—¶é—´æ˜¾ç¤º
            updateTimeDisplay() {
                const currentTime = this.formatTime(this.video.currentTime);
                const duration = this.formatTime(this.video.duration || 0);
                this.timeDisplay.textContent = `${currentTime} / ${duration}`;
            }
        }
        
        // æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ 
        customElements.define('custom-video-player', CustomVideoPlayer);
    </script>
</body>
</html> 